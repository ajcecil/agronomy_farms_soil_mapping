<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLSI Agronomy Farms Maps - Map Viewer</title>
    <!-- link out to your CSS -->
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <header class="header">
      <a href="index.html" class="header-logo-link">
        <img src="page_files/glsi_logo.png" alt="logo" class="header-logo">
      </a>
      <h1>Soil Property Modeling</h1>
    </header>
    <nav class="menu-bar">
      <ul class="menu">
        <li class="dropdown">
            <a href="index.html">Home</a>
        </li>
        <li class="dropdown">
          <a href="webmapping.html">Map Viewer</a>
        </li>
        <li class="dropdown">
          <a href="https://agronomy-farms-soil-mapping.readthedocs.io/">Project Documentation</a>
        </li>
        <li class="dropdown">
          <a href="#">Reference Material ▾</a>
          <ul class="dropdown-menu">
            <li><a href="https://agronomy-farms-soil-mapping.readthedocs.io/" target="_blank">Documentation</a></li>
            <li><a href="https://www.agron.iastate.edu/glsi/" target="_blank">GLSI</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#">Data Sources ▾</a>
          <ul class="dropdown-menu">
            <li><a href="https://apps.nationalmap.gov/lidar-explorer/#/" target="_blank">USGS Lidar Explorer</a></li>
            <li><a href="https://earthengine.google.com/" target="_blank">Google Earth Engine </a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#">Imagery and Data ▾</a>
          <ul class="dropdown-menu">
            <li><a href="https://iastate.box.com/s/ytjl7nqkroxs3haodak27xjpkaqpajh4" target="_blank">Soil Maps</a></li>
          </ul>
      </ul>
    </nav>
<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  // Initialize map
  const map = L.map('map').setView([41.99, -93.74], 12);

  // Add basemap
  const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  // Define raster bounds
  const southWest = L.latLng(41.8821460, -93.8336951);
  const northEast = L.latLng(42.0996281, -93.6558287);
  const rasterBounds = L.latLngBounds(southWest, northEast);

  const BoundedTileLayer = L.TileLayer.extend({
    createTile: function(coords, done) {
      const tileBounds = this._tileCoordsToBounds(coords);
      if (!rasterBounds.intersects(tileBounds)) {
        const empty = document.createElement('div');
        setTimeout(() => done(null, empty), 0);
        return empty;
      }
      return L.TileLayer.prototype.createTile.call(this, coords, done);
    }
  });

  // Add your raster tiles
  const phLayer = new BoundedTileLayer('page_files/maps/PH/tiles/{z}/{x}/{y}.png', {
    attribution: 'pH Map Tiles',
    opacity: 1,
    noWrap: true
  }).addTo(map);

  // Add layer control (shows name)
  L.control.layers(
    { "OpenStreetMap": osm },  // basemaps
    { "Soil pH": phLayer }     // overlays
  ).addTo(map);

  // Add scale bar
  L.control.scale({ position: 'bottomleft', imperial: false }).addTo(map);

  // Add legend (custom control)
  const legend = L.control({position: 'bottomright'});
  legend.onAdd = function () {
    const div = L.DomUtil.create('div', 'legend');
    div.innerHTML = `
      <strong>Soil pH</strong><br>
      <img src="page_files/maps/PH/legend.png" alt="Legend">
    `;
    return div;
  };
  legend.addTo(map);

  // Fit map view to raster
  map.fitBounds(rasterBounds);

  // Constrain map to raster extent
  map.setMaxBounds(rasterBounds);
  map.setMinZoom(9);
  map.setMaxZoom(18);
</script>

</body>
</html>





